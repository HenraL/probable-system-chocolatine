# Original repository: https://github.com/HenraL/probable-system-chocolatine
name: chocolatine
on:
  push:
    branches-ignore:
      - 'ga-ignore-**'
  pull_request:
    branches-ignore:
      - 'ga-ignore-**'
jobs:
  check-for-unwanted-files:
    runs-on: ubuntu-latest
    steps:
      - name: cloning directory into the machine
        uses: actions/checkout@v2
      - name: check_repository_cleanliness
        run: |
          for FILE in *
          do
            if grep -q "*~" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*-;" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "#*" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "#*#" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*#" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*.o" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*.a" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*.exe" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*.so" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*.gcno" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*.gcda" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*.gcov" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "tmp" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*pain_au_chocolat*" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "*pain_au_chocolat" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            elif grep -q "pain_au_chocolat*" $FILE
            then
              echo "::error file=$FILE,line=1,endLine=0,title=Unwanted file detected::$FILE"
              UNWANTED_FILES=1
            fi
          done

      - name: check_program_compilation
        uses: docker://alpine:3.8
      - name: run_tests
        uses: docker://docker.io/epitechcontent/epitest-docker:latest

to_gitlab:
  runs-on: ubuntu-latest
  steps:
    - uses: actions/checkout@v2
      with:
    fetch-depth: 0
    - uses: pixta-dev/repository-mirroring-action@v1
      with:
      target_repo_url:
      https://github.com/HenraL/probable-system-chocolatine.git
      ssh_private_key:
      git@github.com:HenraL/probable-system-chocolatine.git

to_codecommit:
  runs-on: ubuntu-latest
  steps:
    - uses: actions/checkout@v2
      with:
      fetch-depth: 0
    - uses: pixta-dev/repository-mirroring-action@v1
      name: push_to_mirror
      with:
        target_repo_url:
        https://github.com/HenraL/probable-system-chocolatine.git
        ssh_private_key:
        git@github.com:HenraL/probable-system-chocolatine.git
        ssh_username:
        ${{ secrets.SECRET_KEY }}


# name: chocolatine
# on: [push, pull_request]
# jobs:
#   check-for-unwanted-files:
#     runs-on: ubuntu-latest
#     steps:
#       - name: cloning directory into the machine
#         uses: actions/checkout@v2
#       - name: Checking '~' files
#         run: 'for FILE in *; do if grep -q "*~" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '-;' files
#         run: 'for FILE in *; do if grep -q "*-;" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '#*' files
#         run: 'for FILE in *; do if grep -q "#*" $FILE;then  echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done'
#       - name: Checking '#*#' files
#         run: 'for FILE in *; do if grep -q "#*#" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '*#' files
#         run: 'for FILE in *; do if grep -q "*#" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '.o' files
#         run: 'for FILE in *; do if grep -q "*.o" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '.a' files
#         run: 'for FILE in *; do if grep -q "*.a" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '.exe' files
#         run: 'for FILE in *; do if grep -q "*.exe" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '.so' files
#         run: 'for FILE in *; do if grep -q "*.so" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '.gcno' files
#         run: 'for FILE in *; do if grep -q "*.gcno" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '.gcda' files
#         run: 'for FILE in *; do if grep -q "*.gcda" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '.gcov' files
#         run: 'for FILE in *; do if grep -q "*.gcov" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking 'tmp' files
#         run: 'for FILE in *; do if grep -q "tmp" $FILE; then echo "Unwanted folder detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '*pain_au_chocolat*' files
#         run: 'for FILE in *; do if grep -q "*pain_au_chocolat*" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '*pain_au_chocolat' files
#         run: 'for FILE in *; do if grep -q "*pain_au_chocolat" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking 'pain_au_chocolat*' files
#         run: 'for FILE in *; do if grep -q "pain_au_chocolat*" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '*pain*' files
#         run: 'for FILE in *; do if grep -q "*pain*" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '*pain' files
#         run: 'for FILE in *; do if grep -q "*pain" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking 'pain*' files
#         run: 'for FILE in *; do if grep -q "pain*" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '*au_chocolat*' files
#         run: 'for FILE in *; do if grep -q "*au_chocolat*" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '*au_chocolat' files
#         run: 'for FILE in *; do if grep -q "*au_chocolat" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking 'au_chocolat*' files
#         run: 'for FILE in *; do if grep -q "au_chocolat*" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '*chocolat*' files
#         run: 'for FILE in *; do if grep -q "*chocolat*" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking '*chocolat' files
#         run: 'for FILE in *; do if grep -q "*chocolat" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
#       - name: Checking 'chocolat*' files
#         run: 'for FILE in *; do if grep -q "chocolat*" $FILE; then echo "Unwanted file detected: $FILE#L1";echo '::set-output name=SELECTED_COLOR::red'; fi; done;'
